<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
	
	
	<style>
	    #navbarNav {
	        max-height: 0;
	        overflow: hidden;
	        transition: max-height 0.5s ease-in-out;
	    }

	    #navbarNav.show {
	        max-height: 500px; /* Adjust this value as needed */
	    }
</style>
    <title>Thinture GPS</title>
    <link rel="icon" type="image/x-icon" href="THINTURE_IMAGE/favicon.jpg">
</head>
<body>
	  <div th:fragment="navbar_admin">
		<nav class="navbar navbar-expand-lg navbar-dark">
		        <div class="container">
		            <a href="#" class="navbar-brand">
		                <img src="/THINTURE_IMAGE/thinlogo.png" alt="Fleet Tracking Logo" height="50">
		            </a>
					<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
					    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					    <span class="navbar-toggler-icon"></span>
					</button>


		            <div class="collapse navbar-collapse" id="navbarNav">
						<ul class="navbar-nav ms-auto">
						    <li class="nav-item" id="menu-home">
						        <a class="nav-link" href="/admin/dashboard"><strong>HOME</strong></a>
						    </li>
						    <li class="nav-item dropdown" id="menu-admin">
						        <a class="nav-link dropdown-toggle" href="#" id="managerDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
						            <strong>ADMIN</strong>
						        </a>
						        <ul class="dropdown-menu" aria-labelledby="managerDropdown">
						            <li><a class="dropdown-item" href="/admin/adddealer">New Dealer</a></li>
						            <li><a class="dropdown-item" href="/admin/addclient">New Client</a></li>
						            <li><a class="dropdown-item" href="/admin/adduser">New User</a></li>
						            <li><a class="dropdown-item" href="/admin/adddriver">New Driver</a></li>
						        </ul>
						    </li>
						    <li class="nav-item dropdown" id="menu-assign-device">
						        <a class="nav-link dropdown-toggle" href="#" id="configDropdown" data-bs-toggle="dropdown">
						            <strong>ASSIGN DEVICES</strong>
						        </a>
						        <ul class="dropdown-menu">
						            <li><a class="dropdown-item" href="/admin/add_devices_dealer">Add Device To Dealer</a></li>
						            <li><a class="dropdown-item" href="/admin/add_devices_client">Add Device To Client</a></li>
						            <li><a class="dropdown-item" href="/admin/addrfid_dealer">Add RFID To Dealer</a></li>
						            <li><a class="dropdown-item" href="/admin/addrfid_client">Add RFID To Client</a></li>
						        </ul>
						    </li>
						    <li class="nav-item dropdown" id="menu-tracking">
						        <a class="nav-link dropdown-toggle" href="#" id="trackingDropdown" role="button"
						           data-bs-toggle="dropdown" aria-expanded="false">
						            <strong>TRACKING</strong>
						        </a>
						        <ul class="dropdown-menu">
						            <li><a class="dropdown-item" href="/admin/map">Live Map</a></li>
						            <li><a class="dropdown-item" href="/admin/replay">Playback Track</a></li>
						            <li><a class="dropdown-item" href="/map7">maptest</a></li>
						            <li><a class="dropdown-item" href="/map_view">map_view</a></li>
						            <li><a class="dropdown-item" href="/device_logs">device_logs</a></li>
						            <li><a class="dropdown-item" href="/daily_km_chart">/daily_km_chart</a></li>
									
									<li><a class="dropdown-item" href="/admin/serverLogs_admin">server </a></li>
									
						        </ul>
						    </li>
						    <li class="nav-item dropdown" id="menu-configuration">
						        <a class="nav-link dropdown-toggle" href="#" id="configDropdown" data-bs-toggle="dropdown">
						            <strong>CONFIGURATION</strong>
						        </a>
						        <ul class="dropdown-menu">
						            <li><a class="dropdown-item" href="/admin/install">Install</a></li>
									<li><a class="dropdown-item" href="/admin/viewdevices_admin">View S/N and IMEI</a></li>
						        </ul>
						    </li>
						    <li class="nav-item dropdown" id="menu-report">
						        <a class="nav-link dropdown-toggle" href="#" id="reportDropdown" data-bs-toggle="dropdown">
						            <strong>REPORT</strong>
						        </a>
						        <ul class="dropdown-menu">
						            <li><a class="dropdown-item" href="/admin/event">All Reports</a></li>
						           
						        </ul>
						    </li>
						    <li class="nav-item dropdown" id="menu-users">
						        <a class="nav-link dropdown-toggle" href="#" id="reportDropdown" data-bs-toggle="dropdown">
						            <strong>Users Management</strong>
						        </a>
						        <ul class="dropdown-menu" id="menu-users">
						            <li><a class="dropdown-item" href="/admin/dealer_view">Dealer</a></li>
						            <li><a class="dropdown-item" href="/admin/client_view">Client</a></li>
						            <li><a class="dropdown-item" href="/admin/user_view">User</a></li>
						            <li><a class="dropdown-item" href="/admin/driver_view">Driver</a></li>
						        </ul>
						    </li>
						    <li class="nav-item dropdown" id="menu-notifications">
						        <a class="nav-link dropdown-toggle" href="#" id="reportDropdown" data-bs-toggle="dropdown">
						            <strong>NOTIFICATIONS</strong>
						        </a>
						        <ul class="dropdown-menu">
						            <li><a class="dropdown-item" href="/admin/alert">Alerts</a></li>
						        </ul>
						    </li>
						    <li class="nav-item dropdown"  id="menu-profile">
						        <a class="nav-link dropdown-toggle" href="#" id="profileDropdown" data-bs-toggle="dropdown">
						            <strong id="profileid">PROFILE</strong>
						        </a>
						        <ul class="dropdown-menu">
						            <li><a class="dropdown-item" href="/admin/profile_admin">Profile</a></li>
						            <li><a class="dropdown-item" href="/admin/view_complaints">Support</a></li>
						            <li>
						                <a class="dropdown-item logout-item" onclick="logout()">
						                    <i class="fas fa-sign-out-alt"></i> Logout
						                </a>
						            </li>
						        </ul>
						    </li>
						</ul>

		            </div>
		        </div>
		    </nav>
			<div class="navigation-buttons">
								    <button id="backward-button" class="btn btn-secondary">
								        <i class="fas fa-arrow-left"></i> Back
								    </button>
									
								    <button id="forward-button" class="btn btn-secondary">
								        Forward <i class="fas fa-arrow-right"></i>
								    </button>
									
								</div>
		    <!-- Bootstrap JavaScript -->
		    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>

		    <!-- Initialize Bootstrap Dropdown Manually -->
		    <script>
		        document.addEventListener("DOMContentLoaded", function () {
		            var dropdowns = document.querySelectorAll('.dropdown-toggle');
		            dropdowns.forEach(function (dropdown) {
		                new bootstrap.Dropdown(dropdown);
		            });
		        });
		    </script>
			<script>
			 // Function to display username in the navigation bar
			document.addEventListener("DOMContentLoaded", function () {
			 const username = localStorage.getItem("username"); // Retrieve username from localStorage
			const roleLabel = document.getElementById("profileid"); // Get the navigation element

			if (username && roleLabel) {
			roleLabel.innerHTML = `<strong>${username}</strong>`; // Replace "PROFILE" with the username
		}
			});
			
			
			// Logout function
																																				function logout() {
																																				    Swal.fire({
																																				        title: 'Are you sure?',
																																				        text: "You will be logged out of your account.",
																																				        icon: 'warning',
																																				        showCancelButton: true,
																																				        confirmButtonColor: '#3085d6',
																																				        cancelButtonColor: '#d33',
																																				        confirmButtonText: 'Yes, log out!',
																																				        cancelButtonText: 'Cancel'
																																				    }).then((result) => {
																																				        if (result.isConfirmed) {
																																				            // Remove username from localStorage
																																				            localStorage.removeItem("username");

																																				            // Redirect to the login page
																																				            window.location.href = "/login";
																																				        }
																																				    });
																																				}

			
			
			document.addEventListener("DOMContentLoaded", function () {
			    const navbarToggler = document.querySelector(".navbar-toggler");
			    const navbarCollapse = document.querySelector(".navbar-collapse");
			    const dropdowns = document.querySelectorAll(".dropdown");

			    // Toggle the navigation menu
			    navbarToggler.addEventListener("click", function () {
			        navbarCollapse.classList.toggle("show"); // Show or hide menu
			    });

			    // Toggle submenus only on mobile
			    dropdowns.forEach((dropdown) => {
			        const toggle = dropdown.querySelector(".nav-link");

			        toggle.addEventListener("click", function (e) {
			            if (window.innerWidth <= 991) {
			                e.preventDefault(); // Prevent default link behavior
			                
			                // Toggle the clicked dropdown
			                dropdown.classList.toggle("show");

			                // Close other dropdowns when one is opened
			                dropdowns.forEach((otherDropdown) => {
			                    if (otherDropdown !== dropdown) {
			                        otherDropdown.classList.remove("show");
			                    }
			                });
			            }
			        });
			    });

			    // Close menu when clicking outside
			    document.addEventListener("click", function (e) {
			        if (!e.target.closest(".navbar") && !e.target.closest(".dropdown")) {
			            navbarCollapse.classList.remove("show"); // Close menu
			            dropdowns.forEach((dropdown) => {
			                dropdown.classList.remove("show"); // Close dropdowns
			            });
			        }
			    });
			});

</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const navbarToggler = document.querySelector(".navbar-toggler");
        const navbarCollapse = document.querySelector("#navbarNav");
        let isNavbarOpen = false; // Track navbar state

        navbarToggler.addEventListener("click", function () {
            if (!isNavbarOpen) {
                navbarCollapse.style.display = "block"; // Show navbar
                isNavbarOpen = true;
            } else {
                navbarCollapse.style.display = "none"; // Hide navbar
                isNavbarOpen = false;
            }
        });
    });
</script>
<script>
		    document.getElementById('backward-button').addEventListener('click', () => {
		        window.history.back();
		    });

		    document.getElementById('forward-button').addEventListener('click', () => {
		        window.history.forward();
		    });
		</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const adminEmail = localStorage.getItem("username"); // ← already saved on login
    if (!adminEmail) {
      console.warn("⚠️ No email found in localStorage under 'username'");
      return;
    }

    const normalizedEmail = adminEmail.trim().toLowerCase();
    const allowedEmails = ["info1@thinture.com", "info2@thinture.com"];
    const showAllNavItems = allowedEmails.includes(normalizedEmail);

    // List of top-level nav-item <li> IDs
    const allNavItemIds = [
      "menu-home",
      "menu-admin",
      "menu-assign-device",
      "menu-tracking",
      "menu-configuration",
      "menu-report",
      "menu-users",
      "menu-notifications",
      "menu-profile"
    ];

    const allowedNavItemIds = [
      "menu-home",
      "menu-admin",
      "menu-assign-device",
	  "menu-tracking",
      "menu-profile"
    ];

    // Hide all first
    allNavItemIds.forEach(id => {
      const el = document.getElementById(id);
      if (el) el.style.display = "none";
    });

    // Show allowed ones
    const visibleIds = showAllNavItems ? allNavItemIds : allowedNavItemIds;
    visibleIds.forEach(id => {
      const el = document.getElementById(id);
      if (el) el.style.display = "block";
    });

    console.log("✅ Menu adjusted for:", normalizedEmail);
  });
</script>



</body>
</html>
